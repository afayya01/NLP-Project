# Downloading the datasets from Kaggle
import pandas as pd

file_id = '1OESF36p5R3UeMdX6TFggkdkGRlUpmJAI'

# Construct the download link
download_link = f'https://drive.google.com/uc?id={file_id}'

# Read the CSV file into a DataFrame
data = pd.read_csv(download_link)

# Display the first few rows of the DataFrame
data.info(5)
data.head(5)


#Exploratory Data Analysis (EDA)
#Performing data cleaning and preprocessing (handling missing values & removing duplicates).

# Display the number of duplicates and missing values before cleaning
print("Before Cleaning:")
print("Number of duplicates:", data.duplicated().sum())
print("Number of missing values:")
print(data.isnull().sum())

# Fill missing titles with 'No Title'
data['Title'].fillna('No Title', inplace=True)

# Drop rows where 'Review Text' is missing
data.dropna(subset=['Review Text'], inplace=True)

# Fill missing values in 'Division Name', 'Department Name', and 'Class Name' with 'Unknown'
data[['Division Name', 'Department Name', 'Class Name']] = data[['Division Name', 'Department Name', 'Class Name']].fillna('Unknown')

# Display the number of missing values after cleaning
print("\nAfter Cleaning - Number of missing values:")
print(data.isnull().sum())


# Merging the "Title" and "Review Text" columns
data['Merged Review'] = data['Title'].fillna('') + " " + data['Review Text'].fillna('')

data.info(5)
data.head(5)

#Analyzing the distribution of reviews across different age groups, product categories, and ratings.
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Define age bins(intervals) and labels
bins = [18, 25, 35, 45, 55, 65, 100]
labels = ['18-25', '26-35', '36-45', '46-55', '56-65', '65+']
data['Age Group'] = pd.cut(data['Age'], bins=bins, labels=labels, right=False)

# Plot distribution of reviews across age groups
plt.figure(figsize=(10, 6))
sns.countplot(x='Age Group', data=data, order=labels)
plt.title('Distribution of Reviews Across Age Groups')
plt.xlabel('Age Group')
plt.ylabel('Number of Reviews')
plt.xticks(rotation=45)
plt.show()
# Plot for Division Name
plt.figure(figsize=(10, 6))
sns.countplot(x='Division Name', data=data)
plt.title('Distribution of Reviews Across Divisions')
plt.xlabel('Division')
plt.ylabel('Number of Reviews')
plt.xticks(rotation=45)
plt.show()

# Plot for Department Name
plt.figure(figsize=(10, 6))
sns.countplot(x='Department Name', data=data)
plt.title('Distribution of Reviews Across Departments')
plt.xlabel('Departments')
plt.ylabel('Number of Reviews')
plt.xticks(rotation=45)
plt.show()

# Plot for Class Name
plt.figure(figsize=(10, 6))
sns.countplot(x='Class Name', data=data)
plt.title('Distribution of Reviews Across Classes')
plt.xlabel('Classes')
plt.ylabel('Number of Reviews')
plt.xticks(rotation=45)
plt.show()

# Plot for Class Name
plt.figure(figsize=(10, 6))
sns.countplot(x='Rating', data=data)
plt.title('Distribution of Reviews Across Ratings')
plt.xlabel('Ratings')
plt.ylabel('Number of Reviews')
plt.xticks(rotation=45)
plt.show()
